# Качественные характеристики кода (Задание 3)

## 1. Полнота обработки ошибочных данных

В модуле реализована обработка типовых ошибок ввода и запрещенных действий:
- проверка обязательных полей при создании/редактировании заявки;
- проверка формата телефона (допустимые символы и минимальное количество цифр);
- запрет некорректных переходов (например, специалист не переводит заявку в статус «Открыта»);
- проверка прав доступа по ролям (403 при попытке выполнения запрещенного действия);
- информирование пользователя через сообщения (ошибка/предупреждение/информация/успех).

## 2. Наличие тестов для проверки допустимых значений входных данных

Реализованы автотесты на `pytest`:
- `tests/test_statistics.py` — проверка расчета статистики;
- `tests/test_workflow.py` — сценарий работы с заявкой и уведомлениями;
- `tests/test_task3_manager.py` — сценарии модификации: запрос помощи, продление срока, QR‑эндпоинт.

## 3. Средства контроля корректности входных данных

Контроль выполняется на нескольких уровнях:
- уровень формы: `required`, `type="date"`, `min` для количества;
- уровень приложения: проверки и сообщения об ошибках (Flask `flash`);
- уровень базы данных: ограничения `NOT NULL`, `UNIQUE`, `CHECK`, внешние ключи `FOREIGN KEY`.

## 4. Средства восстановления при сбоях оборудования / отказах

Для операций записи в БД используется транзакционный подход:
- при ошибке выполнения SQL выполняется `rollback`;
- пользователь получает информативное сообщение и может повторить операцию;
- важные связанные данные фиксируются в отдельных таблицах (история статусов, история сроков).

Для резервного копирования БД (см. задание 2) предусмотрены SQL‑дамп и копирование файла SQLite.

## 5. Комментарии

Код оформлен так, чтобы читаться без избыточных комментариев. Комментарии как правило не используются для очевидных действий. При необходимости пояснения допускается документирование в отдельных файлах `docs/`.

## 6. Проверка корректности передаваемых данных

Примеры:
- преобразование строковых ID к `int` с обработкой `ValueError`;
- запрет пустых сообщений запроса помощи и пустых комментариев;
- проверка диапазона оценки 1–5 при фиксации отзыва;
- обязательное подтверждение «согласовано с заказчиком» при продлении срока.

## 7. Описание основных функций

Основные функции модификации (задание 3):
- Панель менеджера `/manager/`: список просроченных заявок и открытых запросов помощи.
- Привлечение специалистов: добавление/удаление помощников к заявке (`ticket_specialists`) и уведомления.
- Продление срока: изменение `tickets.due_at` с записью в `ticket_due_history` и признаком согласования.
- Запрос помощи: создание `ticket_help_requests` специалистом и закрытие менеджером.
- Оценка качества: генерация QR‑кода на форму обратной связи и фиксация оценки в `ticket_reviews`.

